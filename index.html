<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0b1020" />
  <title>Maintenance</title>
  <style>
    :root{
      --bg1:#070A14;
      --bg2:#0B1430;
      --c1:#7C3AED;
      --c2:#22D3EE;
      --c3:#F97316;
      --text:#EAF0FF;
      --muted:rgba(234,240,255,.75);
      --glass:rgba(255,255,255,.08);
      --glass2:rgba(255,255,255,.12);
      --stroke:rgba(255,255,255,.18);
      --shadow: 0 18px 70px rgba(0,0,0,.55);
      --radius: 26px;
      --ring: 5.0; /* thickness */
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      overflow:hidden;
      background:
        radial-gradient(1100px 700px at 15% 25%, rgba(124,58,237,.22), transparent 65%),
        radial-gradient(900px 650px at 85% 30%, rgba(34,211,238,.18), transparent 60%),
        radial-gradient(900px 700px at 60% 85%, rgba(249,115,22,.12), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
    }

    /* animated aura */
    .aura{
      position:absolute; inset:-30%;
      background:
        radial-gradient(circle at 20% 30%, rgba(124,58,237,.22), transparent 40%),
        radial-gradient(circle at 70% 40%, rgba(34,211,238,.18), transparent 45%),
        radial-gradient(circle at 55% 75%, rgba(249,115,22,.14), transparent 50%);
      filter: blur(30px);
      animation: drift 14s ease-in-out infinite alternate;
      pointer-events:none;
    }
    @keyframes drift{
      0%{ transform: translate3d(-2%, -1%, 0) scale(1.00) rotate(-2deg); }
      100%{ transform: translate3d(2%, 1.5%, 0) scale(1.05) rotate(2deg); }
    }

    /* floating particles */
    .particles{ position:absolute; inset:0; pointer-events:none; opacity:.85;}
    .p{
      position:absolute;
      width:10px; height:10px;
      border-radius:999px;
      background: radial-gradient(circle at 35% 35%, rgba(255,255,255,.85), rgba(255,255,255,.1));
      filter: blur(.2px);
      animation: float var(--t) linear infinite;
      opacity: var(--o);
      transform: translate3d(0,0,0);
    }
    @keyframes float{
      from { transform: translate3d(var(--x), 110vh, 0) scale(var(--s)); }
      to   { transform: translate3d(calc(var(--x) + var(--dx)), -15vh, 0) scale(calc(var(--s) * 1.12)); }
    }

    .wrap{
      position:relative;
      min-height:100vh;
      display:grid;
      place-items:center;
      padding: 28px 18px;
    }

    .card{
      width:min(980px, 100%);
      border-radius: var(--radius);
      background: linear-gradient(180deg, var(--glass), rgba(255,255,255,.04));
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
    }

    .card::before{
      content:"";
      position:absolute; inset:-2px;
      background: linear-gradient(120deg, rgba(124,58,237,.55), rgba(34,211,238,.35), rgba(249,115,22,.25));
      opacity:.18;
      filter: blur(20px);
      pointer-events:none;
    }

    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      padding: 18px 18px 14px 18px;
      border-bottom:1px solid rgba(255,255,255,.10);
      position:relative;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      font-weight:700;
      letter-spacing:.2px;
    }
    .dot{
      width:10px; height:10px; border-radius:99px;
      background: linear-gradient(135deg, var(--c1), var(--c2));
      box-shadow: 0 0 18px rgba(124,58,237,.55);
      animation:pulse 1.8s ease-in-out infinite;
    }
    @keyframes pulse{
      0%,100%{ transform:scale(1); filter:saturate(1); }
      50%{ transform:scale(1.45); filter:saturate(1.2); }
    }

    .badge{
      display:flex; align-items:center; gap:10px;
      font-size:12px;
      padding:10px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--muted);
      user-select:none;
    }
    .badge strong{ color: var(--text); font-weight:700; }

    .content{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 18px;
      padding: 20px 18px 18px;
      position:relative;
    }
    @media (max-width: 860px){
      .content{ grid-template-columns: 1fr; }
    }

    .left{
      padding: 18px;
      border-radius: 22px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
    }

    h1{
      margin:0 0 10px 0;
      font-size: clamp(26px, 3.2vw, 40px);
      line-height:1.12;
      letter-spacing:-.4px;
    }
    .lead{
      margin:0 0 18px 0;
      color: var(--muted);
      font-size: 15px;
      line-height: 1.6;
      max-width: 62ch;
    }

    .statusline{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      margin: 12px 0 16px;
    }
    .pill{
      padding: 10px 12px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      font-size: 13px;
      color: var(--muted);
      display:flex; align-items:center; gap:10px;
    }
    .pill .k{
      color: var(--text);
      font-weight:700;
      letter-spacing:.2px;
    }

    .timer{
      margin-top: 12px;
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
    }
    @media (max-width: 520px){
      .timer{ grid-template-columns: repeat(2, 1fr); }
    }

    .tbox{
      border-radius: 18px;
      padding: 14px 12px;
      text-align:center;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      position:relative;
      overflow:hidden;
      transform: translateZ(0);
    }
    .tbox::before{
      content:"";
      position:absolute; inset:-1px;
      background: linear-gradient(120deg, rgba(124,58,237,.20), rgba(34,211,238,.14), rgba(249,115,22,.10));
      opacity:.25;
      filter: blur(18px);
      pointer-events:none;
    }
    .num{
      position:relative;
      font-variant-numeric: tabular-nums;
      font-size: clamp(28px, 3vw, 44px);
      font-weight: 800;
      letter-spacing:-.8px;
    }
    .lbl{
      position:relative;
      margin-top: 6px;
      font-size: 12px;
      color: var(--muted);
      letter-spacing:.25px;
      text-transform: uppercase;
    }

    .note{
      margin-top: 16px;
      color: rgba(234,240,255,.78);
      font-size: 13px;
      line-height:1.55;
      border-top:1px dashed rgba(255,255,255,.16);
      padding-top: 14px;
    }

    .right{
      padding: 18px;
      border-radius: 22px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      display:grid;
      gap:14px;
      align-content:start;
    }

    .ringWrap{
      display:grid;
      place-items:center;
      padding: 14px 8px 6px;
    }

    .ring{
      width: 210px; height: 210px;
      position:relative;
      filter: drop-shadow(0 12px 30px rgba(0,0,0,.35));
    }
    .ring svg{ width:100%; height:100%; transform: rotate(-90deg); }
    .ring .center{
      position:absolute; inset:0;
      display:grid; place-items:center;
      text-align:center;
      padding: 22px;
    }
    .big{
      font-variant-numeric: tabular-nums;
      font-weight: 900;
      font-size: 30px;
      letter-spacing:-.6px;
      line-height:1.12;
    }
    .small{
      margin-top:6px;
      font-size:12px;
      color: var(--muted);
      line-height:1.35;
    }

    .cta{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:center;
      margin-top: 6px;
    }
    .btn{
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 14px;
      font-size: 13px;
      cursor:pointer;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      user-select:none;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.10);
      border-color: rgba(255,255,255,.26);
    }

    .footer{
      padding: 14px 18px 18px;
      border-top:1px solid rgba(255,255,255,.10);
      display:flex;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      color: var(--muted);
      font-size: 12px;
      position:relative;
    }
    .footer code{
      background: rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.12);
      padding: 4px 8px;
      border-radius: 10px;
      color: rgba(234,240,255,.90);
    }

    /* subtle entrance */
    .card{
      animation: pop .55s ease-out both;
    }
    @keyframes pop{
      from{ opacity:0; transform: translateY(10px) scale(.98); }
      to{ opacity:1; transform: translateY(0) scale(1); }
    }
  </style>
</head>

<body>
  <div class="aura"></div>
  <div class="particles" id="particles"></div>

  <main class="wrap">
    <section class="card" role="region" aria-label="Maintenance">
      <div class="topbar">
        <div class="brand">
          <span class="dot" aria-hidden="true"></span>
          <span>Maintenance en cours</span>
        </div>
        <div class="badge" id="badge">
          <strong id="phaseLabel">Initialisationâ€¦</strong>
          <span id="windowLabel">â€”</span>
        </div>
      </div>

      <div class="content">
        <div class="left">
          <h1 id="title">Nous amÃ©liorons la plateforme âœ¨</h1>
          <p class="lead" id="subtitle">
            AccÃ¨s temporairement indisponible pendant une opÃ©ration de maintenance planifiÃ©e.
            Le compte Ã  rebours ci-dessous indique le temps restant.
          </p>

          <div class="statusline">
            <div class="pill"><span class="k">DÃ©but</span> <span id="startText">â€”</span></div>
            <div class="pill"><span class="k">Fin</span> <span id="endText">â€”</span></div>
            <div class="pill"><span class="k">Ã‰tat</span> <span id="stateText">â€”</span></div>
          </div>

          <div class="timer" aria-label="Compte Ã  rebours">
            <div class="tbox"><div class="num" id="d">00</div><div class="lbl">Jours</div></div>
            <div class="tbox"><div class="num" id="h">00</div><div class="lbl">Heures</div></div>
            <div class="tbox"><div class="num" id="m">00</div><div class="lbl">Minutes</div></div>
            <div class="tbox"><div class="num" id="s">00</div><div class="lbl">Secondes</div></div>
          </div>

          <div class="note" id="note">
            Si la maintenance dÃ©passe lâ€™heure prÃ©vue, cette page restera affichÃ©e jusquâ€™Ã  rÃ©ouverture.
          </div>
        </div>

        <aside class="right">
          <div class="ringWrap">
            <div class="ring" aria-label="Progression">
              <svg viewBox="0 0 120 120" role="img" aria-label="Anneau de progression">
                <!-- background -->
                <circle cx="60" cy="60" r="48"
                        fill="none"
                        stroke="rgba(255,255,255,.10)"
                        stroke-width="10" />
                <!-- progress -->
                <circle id="ringProgress" cx="60" cy="60" r="48"
                        fill="none"
                        stroke="url(#grad)"
                        stroke-linecap="round"
                        stroke-width="10"
                        stroke-dasharray="301.59"
                        stroke-dashoffset="301.59" />
                <defs>
                  <linearGradient id="grad" x1="0" y1="0" x2="1" y2="1">
                    <stop offset="0%" stop-color="rgba(124,58,237,.95)" />
                    <stop offset="55%" stop-color="rgba(34,211,238,.95)" />
                    <stop offset="100%" stop-color="rgba(249,115,22,.90)" />
                  </linearGradient>
                </defs>
              </svg>

              <div class="center">
                <div class="big" id="centerBig">â€”</div>
                <div class="small" id="centerSmall">â€”</div>
              </div>
            </div>
          </div>

          <div class="cta">
            <button class="btn" id="copyBtn" type="button">Copier lâ€™horaire</button>
            <button class="btn" id="refreshBtn" type="button">Actualiser</button>
          </div>

          <div class="pill" style="justify-content:center">
            <span>Fuseau :</span>
            <span class="k" id="tz">Local</span>
          </div>
        </aside>
      </div>

      <div class="footer">
        <div></div>
        <div>DÃ©verrouillage manuel : <code>?unlock=VOTRE_CODE</code></div>
      </div>
    </section>
  </main>

  <script>
    /**********************************************************************
     *  MAINTENANCE AVEC COMPTE Ã€ REBOURS
     *  - Commence Ã  15h05 aujourdâ€™hui (heure locale du navigateur)
     *  - Se termine demain Ã  15h05
     *  - AprÃ¨s la fin prÃ©vue, on affiche "En attente de rÃ©ouverture"
     *    jusquâ€™Ã  dÃ©verrouillage manuel (vous â€œlâ€™enlevezâ€).
     *
     *  DÃ©verrouillage manuel (optionnel) :
     *    - Ajoutez dans lâ€™URL : ?unlock=VOTRE_CODE
     *    - DÃ©finissez UNLOCK_CODE ci-dessous
     **********************************************************************/

    // ðŸ‘‰ Changez ce code si vous voulez un "dÃ©blocage" simple par URL
    const UNLOCK_CODE = "UNLOCKED";

    // ðŸ‘‰ Si vous voulez forcer la maintenance quoi quâ€™il arrive :
    // (true = toujours bloquÃ© / false = logique automatique + dÃ©verrouillage possible)
    const FORCE_LOCK = true;

    // Horaires : 15:05 -> (15, 5)
    const START_HOUR = 15;
    const START_MIN  = 10;

    // DOM
    const el = (id) => document.getElementById(id);
    const ring = el("ringProgress");
    const CIRC = 2 * Math.PI * 48; // r=48
    ring.style.strokeDasharray = CIRC.toFixed(2);

    function pad(n){ return String(n).padStart(2,"0"); }

    function fmt(dt){
      // Format lisible FR, sans secondes
      return dt.toLocaleString("fr-FR", {
        weekday:"short", year:"numeric", month:"short", day:"2-digit",
        hour:"2-digit", minute:"2-digit"
      });
    }

    function buildWindow(now){
      // Start: aujourdâ€™hui Ã  15:05
      const start = new Date(now);
      start.setHours(START_HOUR, START_MIN, 0, 0);

      // End: demain Ã  15:05 (par rapport au start)
      const end = new Date(start);
      end.setDate(start.getDate() + 1);

      return { start, end };
    }

    function getUnlockFromUrl(){
      const u = new URL(location.href);
      const code = u.searchParams.get("unlock");
      return code && code === UNLOCK_CODE;
    }

    function setParticles(){
      const host = el("particles");
      const count = 18;
      for(let i=0;i<count;i++){
        const d = document.createElement("div");
        d.className = "p";
        d.style.setProperty("--x", Math.round(Math.random()*100) + "vw");
        d.style.setProperty("--dx", (Math.random()*24 - 12) + "vw");
        d.style.setProperty("--s", (Math.random()*0.9 + 0.5).toFixed(2));
        d.style.setProperty("--t", (Math.random()*14 + 12).toFixed(2) + "s");
        d.style.setProperty("--o", (Math.random()*0.35 + 0.25).toFixed(2));
        d.style.left = Math.round(Math.random()*100) + "vw";
        d.style.top = Math.round(Math.random()*100) + "vh";
        host.appendChild(d);
      }
    }

    function renderCountdown(ms){
      const total = Math.max(0, ms);
      const sec = Math.floor(total/1000);
      const days = Math.floor(sec / 86400);
      const hrs  = Math.floor((sec % 86400) / 3600);
      const mins = Math.floor((sec % 3600) / 60);
      const s    = sec % 60;

      el("d").textContent = pad(days);
      el("h").textContent = pad(hrs);
      el("m").textContent = pad(mins);
      el("s").textContent = pad(s);

      // affichage central
      if(days > 0){
        el("centerBig").textContent = `${days}j ${pad(hrs)}h`;
      }else{
        el("centerBig").textContent = `${pad(hrs)}:${pad(mins)}:${pad(s)}`;
      }
    }

    function setRingProgress(progress01){
      const p = Math.min(1, Math.max(0, progress01));
      const offset = CIRC * (1 - p);
      ring.style.strokeDashoffset = offset.toFixed(2);
    }

    function tick(){
      const now = new Date();
      const { start, end } = buildWindow(now);

      // labels
      el("startText").textContent = fmt(start);
      el("endText").textContent = fmt(end);
      el("tz").textContent = Intl.DateTimeFormat().resolvedOptions().timeZone || "Local";

      // DÃ©verrouillage manuel (si FORCE_LOCK est false)
      const unlocked = getUnlockFromUrl() && !FORCE_LOCK;

      let phase = "";
      let state = "";
      let targetMs = 0;
      let ringP = 0;

      const duration = end - start;

      if(unlocked){
        phase = "DÃ©verrouillÃ©";
        state = "AccÃ¨s rÃ©tabli (manuel)";
        el("title").textContent = "Maintenance levÃ©e âœ…";
        el("subtitle").textContent = "Le site a Ã©tÃ© rouvert manuellement. Vous pouvez fermer cette page.";
        el("note").textContent = "Astuce : retirez le paramÃ¨tre ?unlock=â€¦ pour revenir au mode normal.";
        el("centerSmall").textContent = "RÃ‰OUVERT";
        renderCountdown(0);
        setRingProgress(1);
        el("phaseLabel").textContent = phase;
        el("windowLabel").textContent = "â€”";
        el("stateText").textContent = state;
        return;
      }

      // LOGIQUE PRINCIPALE
      if(now < start){
        // Avant le dÃ©but : compte Ã  rebours jusquâ€™au dÃ©marrage
        phase = "Ã€ venir";
        state = "Maintenance programmÃ©e";
        targetMs = start - now;

        el("title").textContent = "Maintenance programmÃ©e â³";
        el("subtitle").textContent =
          "Le site va passer en maintenance. Le compte Ã  rebours indique le temps avant le dÃ©but.";
        el("note").textContent =
          "Une fois dÃ©marrÃ©e, lâ€™accÃ¨s restera bloquÃ© jusquâ€™Ã  la fin (et Ã©ventuellement jusquâ€™Ã  rÃ©ouverture manuelle).";

        const untilStart = 1 - (targetMs / Math.max(1, 6*60*60*1000)); // joli â€œprÃ©-chauffageâ€
        ringP = Math.min(1, Math.max(0, untilStart));
        el("centerSmall").textContent = "AVANT DÃ‰MARRAGE";
      }else if(now >= start && now < end){
        // Pendant : temps restant jusquâ€™Ã  la fin
        phase = "En cours";
        state = "AccÃ¨s indisponible";
        targetMs = end - now;

        el("title").textContent = "Maintenance en cours ðŸ› ï¸";
        el("subtitle").textContent =
          "Nous effectuons des amÃ©liorations. Merci pour votre patience, on revient bientÃ´t.";
        el("note").textContent =
          "Si vous voyez cette page aprÃ¨s lâ€™heure prÃ©vue, la maintenance a peut-Ãªtre Ã©tÃ© prolongÃ©e.";

        ringP = 1 - (targetMs / duration);
        el("centerSmall").textContent = "PROGRESSION";
      }else{
        // AprÃ¨s la fin prÃ©vue : on laisse la page bloquÃ©e jusquâ€™Ã  ce que VOUS â€œlâ€™enleviezâ€
        phase = "TerminÃ© (horaire)";
        state = FORCE_LOCK ? "En attente de rÃ©ouverture (manuel)" : "Vous pouvez dÃ©verrouiller (manuel)";
        targetMs = 0;

        el("title").textContent = "Maintenance terminÃ©e (horaire) âœ…";
        el("subtitle").textContent =
          "La fenÃªtre planifiÃ©e est terminÃ©e. Cette page reste affichÃ©e jusquâ€™Ã  rÃ©ouverture manuelle.";
        el("note").textContent =
          FORCE_LOCK
            ? "FORCE_LOCK est activÃ© : la page restera bloquÃ©e tant que vous ne dÃ©sactivez pas ce mode dans le code."
            : "DÃ©verrouillage : ajoutez ?unlock=VOTRE_CODE Ã  lâ€™URL (et dÃ©finissez UNLOCK_CODE dans le script).";

        ringP = 1;
        el("centerSmall").textContent = "EN ATTENTE";
      }

      // Rendu
      el("phaseLabel").textContent = phase;
      el("windowLabel").textContent = `${start.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})} â†’ ${end.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}`;
      el("stateText").textContent = state;

      renderCountdown(targetMs);
      setRingProgress(ringP);
    }

    // Buttons
    el("refreshBtn").addEventListener("click", () => location.reload());
    el("copyBtn").addEventListener("click", async () => {
      const now = new Date();
      const { start, end } = buildWindow(now);
      const text = `Maintenance: ${fmt(start)} â†’ ${fmt(end)}`;
      try{
        await navigator.clipboard.writeText(text);
        el("copyBtn").textContent = "CopiÃ© âœ…";
        setTimeout(()=> el("copyBtn").textContent = "Copier lâ€™horaire", 1400);
      }catch(e){
        // fallback
        prompt("Copiez :", text);
      }
    });

    // init
    setParticles();
    tick();
    setInterval(tick, 1000);
  </script>
</body>
</html>

